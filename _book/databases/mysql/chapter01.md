范式 | 类型 | 索引 | 锁 | 事务 | 执行计划 | 主从同步 | 读写分离 | 分库分表 | sharding-sphere | 高可用 

类型：char和varchar最大长度

索引
建议使用自增类型作为索引。聚合索引ABC索引匹配A，AB，ABC。
B+tree：
InnoDB：聚集索引，默认索引（int>非空的string），主键索引，非主键索引到主键索引。
MySam：非聚集索引。

锁
表级锁：全表扫描
页级锁：
行级锁：innoDB使用行级锁，直接锁定的是索引。使用主键索引则锁定主键，使用非主键索引这先锁定非主键索引再锁定主键索引，如果非索引检索，则自动转化为表级锁。
共享锁：lock in share mode
独享锁：for update
悲观锁：抽象锁，针对读操作，过程中使用for update排它锁锁定
乐观锁：抽象锁，针对读，通过给定时间戳或者版本号的形式进行更新，如果失败则执行N次的重试即可。

主从同步
binlog为操作日志文件，可以设定期限，不包含select命令。
写操作到Master阻塞执行写binlog和data，slave两条线程，IO线程从异步从Master的binlog读取到relayBinlog中，SQL线程从relayBinlog中读取写入本地binlog和data中。
半同步操作是从5.6之后，写入操作阻塞同步数据到Slave的relayBinlog中，可以设定等待超市。
读写分离可采用中间件实现如atlas，如果写入后马上查询可采用强制从Master中查询。
主从同步配置
可以配置哪些数据库需要同步，哪些不需要同步。

读写分离


分库分表
1：垂直分：大库按照业务剥离拆分为小库（对结构拆分），如订单库，会员库，商品库。缺点：要修改现有应用程序，单表数据量大的话压力依然大造成单表瓶颈，无法跨库join；优点：转库专用业务清晰，动静、冷热数据分离，业务单一维护简单。
2：水平分：按照某个规律，把所有的业务表拆分到各个库中（对内容拆分）。缺点：拆分规则难以抽象，设计没有前瞻性的话扩容难度大，无法跨库join；优点：单库表数据量趋小，性能好，提高系统负载能力，拆分后，数据结构相同业务程序改动小；
3：混合型，垂直按照业务分库，然后水平按照数据分表。
4：带来的问题：维护成本增加，分布式事务，跨库join，分布式唯一ID（雪花算法，隐患机器时间需要强一致性）。
5：常用算法：hash取模（优点：数据分布均匀，缺点：扩容困难（一致性hash可以搞定）），范围区分（热点问题无法避免），预定义（假设条件失效）。
6：常见中间件JDBC：sharding-jdbc，TDDL；Proxy：mycat，sharding-sphere；atlas

